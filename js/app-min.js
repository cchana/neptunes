let songs,storedDecadeFilter=0,reverse=!1;const validDecades=[1990,2e3,2010,2020];function _generateSongs(e,t){let n="",o=[];return t?o.push(t):(o=validDecades.map((e=>e)),reverse&&(o=o.reverse())),o.forEach((t=>{n+=`<section><h2 id="${t}s">${t}s</h2>`;let o=t,s=t;if(reverse)for(o=s+9;o>=s;){if(void 0!==e[t][o]&&e[t][o].length>0){n+=`<h3 id="year=${o}">${o}</h3>\n\t\t\t\t\t<div>`,e[t][o].map((e=>e)).reverse().forEach((e=>{n+=_template(e)})),n+="</div>"}o--}else for(s=t+10;o<s;)void 0!==e[t][o]&&e[t][o].length>0&&(n+=`<h3 id="year=${o}"><span>${o}</span></h3>\n\t\t\t\t\t<div>`,e[t][o].forEach((e=>{n+=_template(e)})),n+="</div>"),o++;n+="</section>"})),n}function _template(e){let t="<dl>\n\t\t<dt>";return""!==e.artwork&&(t+=`<img src="${e.artwork}" alt="${e.title+" by "+e.artist}" loading="lazy" />`),t+=`<h3>\n\t\t\t\t${e.title}\n\t\t\t\t<em>${e.artist}</em>\n\t\t\t</h3>\n\t\t</dt>\n\t\t<dd>\n\t\t\t<ol>`,e.songs.forEach((e=>{t+="<li>"+e.title,void 0!==e.featuring&&e.featuring.length>0&&(t+=` <small>(featuring ${e.featuring.join(", ")})</small>`),t+="</li>"})),t+='</ol>\n\t\t\t\x3c!--div>\n\t\t\t\t<p>Listen: <a href="#">Apple Music</a>, <a href="#">Spotify</a>, <a href="#">Amazon Music</a></p>\n\t\t\t</div--\x3e\n\t\t</dd>\n\t</dl>',t}function highlightDecade(e){document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),document.querySelector(".songs-"+e).classList.add("selected")}function getSongs(e){let t=document.querySelector("#songs");void 0===songs?(t.innerHTML="<p>Loading</p>",fetch("./data-min.json?v=1015").then((e=>e.json())).then((n=>{songs=n,t.innerHTML=_generateSongs(n,e)})).catch((function(e){console.log(e)}))):t.innerHTML=_generateSongs(songs,e)}function searchSongs(e){let t={};const n=e.toLowerCase().trim();validDecades.forEach((e=>{let o=e,s=e+10;for(;o<s;)void 0!==songs[e][o]&&(void 0===t[e]&&(t[e]={}),t[e][o]=songs[e][o].filter((function(e){if(e.title.toLowerCase().includes(n))return e;if(e.artist.toLowerCase().includes(n))return e;let t=!1;return e.songs.forEach((e=>{e.title.toLowerCase().includes(n)&&(t=!0),e.featuring.forEach((e=>{e.toLowerCase().includes(n)&&(t=!0)}))})),t?e:void 0}))),o++})),document.querySelector("#songs").innerHTML=_generateSongs(t)}window.onload=function(){if(""!==window.location.hash&&"#0000s"!==window.location.hash){const e=parseInt(window.location.hash.substring(1,5));!isNaN(e)&&e>=1990?(getSongs(e),highlightDecade(e)):getSongs()}else getSongs();document.querySelectorAll(".filter-decade").forEach((e=>{e.addEventListener("click",(function(e){if(e.preventDefault(),document.getElementById("searchBox").value="",document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),void 0!==e.target.attributes.href){const t=e.target.attributes.href.value.substring(1,5);storedDecadeFilter=t,window.location.hash=`#${t}s`,getSongs(t),e.target.parentElement.classList.add("selected")}else getSongs();window.scroll(0,0)}))})),document.getElementById("searchBox").addEventListener("keyup",(function(e){document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),window.location.hash="",storedDecadeFilter=0,searchSongs(this.value)})),document.getElementById("reverseResults").addEventListener("change",(function(e){reverse=this.checked;let t=document.getElementById("searchBox").value;""===t?getSongs(storedDecadeFilter):searchSongs(t)}))};