let songs,storedDecadeFilter=0,reverse=!1;const validDecades=[1990,2e3,2010,2020];function _generateSongs(e,t){let n="",s=[];return t?s.push(t):(s=validDecades.map((e=>e)),reverse&&(s=s.reverse())),s.forEach((t=>{let s="",o=t,r=t;if(reverse)for(o=r+9;o>=r;){if(void 0!==e[t][o]&&e[t][o].length>0){let n=e[t][o].map((e=>e)),r="";n.reverse().forEach((e=>{r+=_template(e)})),""!==r&&(s+=`<h3 id="year=${o}"><span>${o}</span></h3><div>${r}</div>`)}o--}else for(r=t+10;o<r;){if(void 0!==e[t][o]&&e[t][o].length>0){let n="";e[t][o].forEach((e=>{n+=_template(e)})),""!==n&&(s+=`<h3 id="year=${o}"><span>${o}</span></h3><div>${n}</div>`)}o++}""!==s&&(n+=`<section><h2 id="${t}s">${t}s</h2>${s}</section>`)})),n}function _template(e){let t="<dl>\n\t\t<dt>";return""!==e.artwork&&(t+=`<img src="${e.artwork}" alt="${e.title+" by "+e.artist}" loading="lazy" />`),t+=`<h3>\n\t\t\t\t${e.title}\n\t\t\t\t<em>${e.artist}</em>\n\t\t\t</h3>`,""!==e.links.apple&&(t+=`<a href="${e.links.apple}">Apple Music</a>`),t+="</dt>\n\t\t<dd>\n\t\t\t<ol>",e.songs.forEach((e=>{t+="<li>"+e.title,void 0!==e.featuring&&e.featuring.length>0&&(t+=` <small>(featuring ${e.featuring.join(", ")})</small>`),t+="</li>"})),t+="</ol>\n\t\t</dd>\n\t</dl>",t}function highlightDecade(e){document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),document.querySelector(".songs-"+e).classList.add("selected")}function getSongs(e){let t=document.querySelector("#songs");void 0===songs?(t.innerHTML="<p>Loading</p>",fetch("./data-min.json?v=1015").then((e=>e.json())).then((n=>{songs=n,t.innerHTML=_generateSongs(n,e)})).catch((function(e){console.log(e)}))):t.innerHTML=_generateSongs(songs,e)}function searchSongs(e){let t={};const n=e.toLowerCase().trim();validDecades.forEach((e=>{let s=e,o=e+10;for(;s<o;)void 0!==songs[e][s]&&(void 0===t[e]&&(t[e]={}),t[e][s]=songs[e][s].filter((function(e){if(e.title.toLowerCase().includes(n))return e;if(e.artist.toLowerCase().includes(n))return e;let t=!1;return e.songs.forEach((e=>{e.title.toLowerCase().includes(n)&&(t=!0),e.featuring.forEach((e=>{e.toLowerCase().includes(n)&&(t=!0)}))})),t?e:void 0}))),s++}));let s=_generateSongs(t),o=document.querySelector("#songs");o.innerHTML=""!==s?s:"<p>There were no results matching your search</p>"}window.onload=function(){if(""!==window.location.hash&&"#0000s"!==window.location.hash){const e=parseInt(window.location.hash.substring(1,5));!isNaN(e)&&e>=1990?(getSongs(e),highlightDecade(e)):getSongs()}else getSongs();document.querySelectorAll(".filter-decade").forEach((e=>{e.addEventListener("click",(function(e){if(e.preventDefault(),document.getElementById("searchBox").value="",document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),void 0!==e.target.attributes.href){const t=e.target.attributes.href.value.substring(1,5);storedDecadeFilter=t,window.location.hash=`#${t}s`,getSongs(t),e.target.parentElement.classList.add("selected")}else getSongs();window.scroll(0,0)}))})),document.getElementById("searchBox").addEventListener("keyup",(function(e){document.querySelectorAll(".filter-decade").forEach((e=>{e.parentElement.classList.remove("selected")})),window.location.hash="",storedDecadeFilter=0,searchSongs(this.value)})),document.getElementById("reverseResults").addEventListener("change",(function(e){reverse=this.checked;let t=document.getElementById("searchBox").value;""===t?getSongs(storedDecadeFilter):searchSongs(t)}))};